import{o as a,d as l,e as c,m as k,F as b,f as $,p as x,n as z,r as S,b as C,k as D,j as m,l as g,g as p,h as N,i as y,s as P,t as T,q as F,v as V,x as L,y as v,T as q,z as G}from"./index-0b66b6e9.js";import"./browser-ponyfill-2fa155e1.js";var A=function(){if(typeof Map<"u")return Map;function t(e,n){var i=-1;return e.some(function(s,o){return s[0]===n?(i=o,!0):!1}),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(n){var i=t(this.__entries__,n),s=this.__entries__[i];return s&&s[1]},e.prototype.set=function(n,i){var s=t(this.__entries__,n);~s?this.__entries__[s][1]=i:this.__entries__.push([n,i])},e.prototype.delete=function(n){var i=this.__entries__,s=t(i,n);~s&&i.splice(s,1)},e.prototype.has=function(n){return!!~t(this.__entries__,n)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(n,i){i===void 0&&(i=null);for(var s=0,o=this.__entries__;s<o.length;s++){var r=o[s];n.call(i,r[1],r[0])}},e}()}(),R=typeof window<"u"&&typeof document<"u"&&window.document===document,w=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),J=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(w):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),I=2;function Y(t,e){var n=!1,i=!1,s=0;function o(){n&&(n=!1,t()),i&&u()}function r(){J(o)}function u(){var d=Date.now();if(n){if(d-s<I)return;i=!0}else n=!0,i=!1,setTimeout(r,e);s=d}return u}var K=20,X=["top","right","bottom","left","width","height","size","weight"],U=typeof MutationObserver<"u",Q=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Y(this.refresh.bind(this),K)}return t.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},t.prototype.removeObserver=function(e){var n=this.observers_,i=n.indexOf(e);~i&&n.splice(i,1),!n.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},t.prototype.updateObservers_=function(){var e=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return e.forEach(function(n){return n.broadcastActive()}),e.length>0},t.prototype.connect_=function(){!R||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),U?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){!R||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(e){var n=e.propertyName,i=n===void 0?"":n,s=X.some(function(o){return!!~i.indexOf(o)});s&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),j=function(t,e){for(var n=0,i=Object.keys(e);n<i.length;n++){var s=i[n];Object.defineProperty(t,s,{value:e[s],enumerable:!1,writable:!1,configurable:!0})}return t},_=function(t){var e=t&&t.ownerDocument&&t.ownerDocument.defaultView;return e||w},H=E(0,0,0,0);function O(t){return parseFloat(t)||0}function M(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(i,s){var o=t["border-"+s+"-width"];return i+O(o)},0)}function Z(t){for(var e=["top","right","bottom","left"],n={},i=0,s=e;i<s.length;i++){var o=s[i],r=t["padding-"+o];n[o]=O(r)}return n}function tt(t){var e=t.getBBox();return E(0,0,e.width,e.height)}function et(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return H;var i=_(t).getComputedStyle(t),s=Z(i),o=s.left+s.right,r=s.top+s.bottom,u=O(i.width),d=O(i.height);if(i.boxSizing==="border-box"&&(Math.round(u+o)!==e&&(u-=M(i,"left","right")+o),Math.round(d+r)!==n&&(d-=M(i,"top","bottom")+r)),!it(t)){var h=Math.round(u+o)-e,f=Math.round(d+r)-n;Math.abs(h)!==1&&(u-=h),Math.abs(f)!==1&&(d-=f)}return E(s.left,s.top,u,d)}var nt=function(){return typeof SVGGraphicsElement<"u"?function(t){return t instanceof _(t).SVGGraphicsElement}:function(t){return t instanceof _(t).SVGElement&&typeof t.getBBox=="function"}}();function it(t){return t===_(t).document.documentElement}function st(t){return R?nt(t)?tt(t):et(t):H}function ot(t){var e=t.x,n=t.y,i=t.width,s=t.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,r=Object.create(o.prototype);return j(r,{x:e,y:n,width:i,height:s,top:n,right:e+i,bottom:s+n,left:e}),r}function E(t,e,n,i){return{x:t,y:e,width:n,height:i}}var rt=function(){function t(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=E(0,0,0,0),this.target=e}return t.prototype.isActive=function(){var e=st(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},t}(),ct=function(){function t(e,n){var i=ot(n);j(this,{target:e,contentRect:i})}return t}(),at=function(){function t(e,n,i){if(this.activeObservations_=[],this.observations_=new A,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=n,this.callbackCtx_=i}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof _(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)||(n.set(e,new rt(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof _(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)&&(n.delete(e),n.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&e.activeObservations_.push(n)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,n=this.activeObservations_.map(function(i){return new ct(i.target,i.broadcastRect())});this.callback_.call(e,n,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),W=typeof WeakMap<"u"?new WeakMap:new A,B=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=Q.getInstance(),i=new at(e,n,this);W.set(this,i)}return t}();["observe","unobserve","disconnect"].forEach(function(t){B.prototype[t]=function(){var e;return(e=W.get(this))[t].apply(e,arguments)}});var lt=function(){return typeof w.ResizeObserver<"u"?w.ResizeObserver:B}();const ht={class:"c-scrollbars"},ut=["onPointerdown"];function dt(t,e,n,i,s,o){return a(),l("div",ht,[c("div",{class:"scroll-content",ref:"content",onScroll:e[0]||(e[0]=(...r)=>o.onScroll&&o.onScroll(...r))},[k(t.$slots,"default")],544),(a(!0),l(b,null,$(Object.keys(s.dimensions),r=>(a(),l("div",{class:x([`scrollbar-rail-${r}`,{active:s.draggingDimension===r}]),onPointerdown:u=>o.onPointerdown(r,u)},[c("div",{class:"scrollbar-thumb",ref_for:!0,ref:`thumb-${r}`,style:z(o.thumbStyles[r])},null,4)],42,ut))),256))])}const ft=(t,e)=>{const n=t.__vccOpts||t;for(const[i,s]of e)n[i]=s;return n},vt={components:{},props:{y:Boolean,x:Boolean},data(){return{dimensions:null,draggingDimension:null,draggingOffset:null}},computed:{thumbStyles(){var e,n;const t={};if((e=this.dimensions)!=null&&e.x&&(t.x={width:this.dimensions.x.thumbLength+"px",left:this.dimensions.x.thumbPosition+"px"},this.dimensions.x.visibleRatio>=1&&(t.x.display="none")),(n=this.dimensions)!=null&&n.y){const i=this.dimensions.y.direction==="reverse"?"bottom":"top";t.y={height:this.dimensions.y.thumbLength+"px",[i]:this.dimensions.y.thumbPosition+"px"},this.dimensions.y.visibleRatio>=1&&(t.y.display="none")}return t}},created(){const t={};this.x&&(t.x={visibleRatio:null,thumbLength:null,thumbPosition:null}),this.y&&(t.y={visibleRatio:null,thumbLength:null,thumbPosition:null,direction:null}),this.dimensions=t},async mounted(){await this.$nextTick(),this.dimensions.y&&window.getComputedStyle(this.$refs.content).flexDirection.endsWith("reverse")&&(this.dimensions.y.direction="reverse"),this.computeDimensions(),this.computeThumbPositions(),this.resizeObserver=new lt(this.onResize),this.resizeObserver.observe(this.$refs.content);for(const t of this.$refs.content.children)this.resizeObserver.observe(t);this.mutationObserver=new MutationObserver(t=>{for(const e of t){for(const n of e.addedNodes)n.nodeType===Node.ELEMENT_NODE&&this.resizeObserver.observe(n);for(const n of e.removedNodes)n.nodeType===Node.ELEMENT_NODE&&this.resizeObserver.unobserve(n)}this.onResize()}),this.mutationObserver.observe(this.$refs.content,{childList:!0})},beforeDestroy(){this.resizeObserver.disconnect(),this.mutationObserver.disconnect()},methods:{scrollTop(t){this.$refs.content.scrollTop=t},onScroll(t){this.$emit("scroll",t),this.computeThumbPositions()},onResize(){this.computeDimensions(),this.computeThumbPositions(),this.$emit("resize")},onPointerdown(t,e){const n=this.$refs[`thumb-${t}`][0];event.stopPropagation(),n.setPointerCapture(event.pointerId),this.draggingDimension=t,this.draggingOffset=event[`offset${t.toUpperCase()}`],n.addEventListener("pointermove",this.onPointermove),n.addEventListener("pointerup",this.onPointerup)},onPointermove(){if(this.draggingDimension==="x"){const t=this.$refs.content.clientWidth-this.dimensions.x.thumbLength,e=event.clientX-this.$refs.content.getBoundingClientRect().left-this.draggingOffset;this.dimensions.x.thumbPosition=Math.min(Math.max(0,e),t),this.$refs.content.scrollLeft=this.dimensions.x.thumbPosition/t*(this.$refs.content.scrollWidth-this.$refs.content.clientWidth)}if(this.draggingDimension==="y"){const t=this.$refs.content.clientHeight-this.dimensions.y.thumbLength;if(this.dimensions.y.direction==="reverse"){const e=this.$refs.content.clientHeight-(event.clientY-this.$refs.content.getBoundingClientRect().top+(this.dimensions.y.thumbLength-this.draggingOffset));this.dimensions.y.thumbPosition=Math.min(Math.max(0,e),t),this.$refs.content.scrollTop=-1*this.dimensions.y.thumbPosition/t*(this.$refs.content.scrollHeight-this.$refs.content.clientHeight)}else{const e=event.clientY-this.$refs.content.getBoundingClientRect().top-this.draggingOffset;this.dimensions.y.thumbPosition=Math.min(Math.max(0,e),t),this.$refs.content.scrollTop=this.dimensions.y.thumbPosition/t*(this.$refs.content.scrollHeight-this.$refs.content.clientHeight)}}},onPointerup(t){const e=this.draggingDimension,n=this.$refs[`thumb-${e}`][0];this.draggingDimension=null,n.releasePointerCapture(t.pointerId),n.removeEventListener("pointermove",this.onPointermove),n.removeEventListener("pointerup",this.onPointerup)},computeDimensions(){this.dimensions.x&&(this.dimensions.x.visibleRatio=this.$refs.content.clientWidth/this.$refs.content.scrollWidth,this.dimensions.x.thumbLength=this.$refs.content.clientWidth*this.dimensions.x.visibleRatio),this.dimensions.y&&(this.dimensions.y.visibleRatio=this.$refs.content.clientHeight/this.$refs.content.scrollHeight,this.dimensions.y.thumbLength=this.$refs.content.clientHeight*this.dimensions.y.visibleRatio)},computeThumbPositions(){this.dimensions.x&&(this.dimensions.x.thumbPosition=this.$refs.content.scrollLeft/(this.$refs.content.scrollWidth-this.$refs.content.clientWidth)*(this.$refs.content.clientWidth-this.dimensions.x.thumbLength)),this.dimensions.y&&(this.dimensions.y.direction==="reverse"?this.dimensions.y.thumbPosition=-1*this.$refs.content.scrollTop/(this.$refs.content.scrollHeight-this.$refs.content.clientHeight)*(this.$refs.content.clientHeight-this.dimensions.y.thumbLength):this.dimensions.y.thumbPosition=this.$refs.content.scrollTop/(this.$refs.content.scrollHeight-this.$refs.content.clientHeight)*(this.$refs.content.clientHeight-this.dimensions.y.thumbLength))},updateThumb(t){const e=this[t];e&&(e.visibleRatio>=1?e.thumbEl.style.display="none":(e.thumbEl.style.display=null,t==="x"?(e.railEl.style.width=e.railLength+"px",e.thumbEl.style.width=e.thumbLength+"px",e.thumbEl.style.left=e.thumbPosition+"px"):t==="y"&&(e.railEl.style.height=e.railLength+"px",e.thumbEl.style.height=e.thumbLength+"px",e.thumbEl.style.top=e.thumbPosition+"px")))}}},mt=ft(vt,[["render",dt]]);const pt={__name:"Prompt",props:{allowCancel:{type:Boolean,default:!0}},emits:["close"],setup(t,{emit:e}){const n=S(null);function i(o){this.allowCancel&&(o.stopPropagation(),n.value.addEventListener("pointerup",s))}function s(o){n.value.removeEventListener("pointerup",s),o.target===n.value&&e("close")}return(o,r)=>{const u=C("bunt-icon-button");return a(),l("div",{class:"c-prompt",ref_key:"el",ref:n,onPointerdown:i},[c("div",{class:"prompt-wrapper",ref:"wrapper",onPointerdown:r[1]||(r[1]=N(()=>{},["stop"]))},[t.allowCancel?(a(),D(u,{key:0,id:"btn-close",onClick:r[0]||(r[0]=d=>o.$emit("close"))},{default:m(()=>[g("close")]),_:1})):p("",!0),k(o.$slots,"default",{class:"content"})],544)],544)}}};const _t={class:"content"},bt=c("h2",null,"Abort your journey and start a new one?",-1),yt={class:"actions"},gt={__name:"AbortJourneyPrompt",emits:["close"],setup(t,{emit:e}){async function n(){await P.abortActiveJourney(),e("close")}return(i,s)=>{const o=C("bunt-button");return a(),D(pt,{class:"c-cancel-journey-prompt",onClose:s[1]||(s[1]=r=>e("close"))},{default:m(()=>[c("div",_t,[bt,c("div",yt,[y(o,{id:"btn-continue",onClick:s[0]||(s[0]=r=>e("close"))},{default:m(()=>[g("Continue journey")]),_:1}),y(o,{id:"btn-cancel-journey",onClick:n},{default:m(()=>[g("Abort journey")]),_:1})])])]),_:1})}}};const wt={class:"c-journey"},Ot={key:0,class:"journey-chooser"},Et=c("h2",null,"Choose a Journey",-1),$t={class:"journeys"},xt=["onClick"],Pt={class:"name"},Rt={class:"length"},Ct={key:1,class:"journey-tracker"},Dt={class:"journey"},Tt={class:"text"},Lt={class:"name"},Mt={class:"description"},kt={class:"da-container"},zt={class:"actions"},St={class:"distances"},At={class:"travelled"},jt=c("span",null,"/",-1),Ht={class:"total"},Wt={class:"journey-legs"},Bt={class:"path-segment"},Nt=c("div",{class:"waypoint"},null,-1),Ft={class:"content"},Vt={class:"waypoint-info"},qt={class:"directions"},Gt={class:"distance"},Jt={key:0,class:"quote"},Kt={__name:"Journey",setup(t){const e=P,n=T(e,"activeJourney"),i=T(e,"travelledDistance");let s=S(!1);return(o,r)=>{const u=C("bunt-icon-button"),d=F("scrollbar");return a(),l("div",wt,[n.value?(a(),l("div",Ct,[c("div",Dt,[c("div",Tt,[c("h3",Lt,v(n.value.name),1),c("div",Mt,v(n.value.description),1)]),c("div",kt,[c("div",zt,[y(u,{id:"btn-abort-journey",onClick:r[0]||(r[0]=h=>s.value=!0)},{default:m(()=>[g("sign-direction-remove")]),_:1})]),c("div",St,[c("div",At,v((i.value/1e3).toFixed(2))+" km",1),jt,c("div",Ht,v((n.value.totalDistance/1e3).toFixed(2))+" km",1)])])]),y(mt,{class:"journey-legs-scroller",y:""},{default:m(()=>[c("div",Wt,[(a(!0),l(b,null,$(n.value.legs,(h,f)=>(a(),l(b,null,[h.show?(a(),l("div",{key:0,class:x(["journey-leg",{start:f===0,end:f===n.value.legs.length-1,reached:h.remainingDistance===0}])},[c("div",Bt,[Nt,n.value.legs[f+1].show?(a(),l(b,{key:0},[n.value.legs[f+1].remainingDistance>0?(a(),l("div",{key:0,class:"path partial",style:z({"--remaining":n.value.legs[f+1].remainingDistance/n.value.legs[f+1].distance})},null,4)):p("",!0),c("div",{class:x(["path",{remaining:n.value.legs[f+1].remainingDistance>0}])},null,2)],64)):p("",!0)]),c("div",Ft,[c("div",Vt,[c("div",qt,v(h.directions),1),c("div",Gt,v((h.distance/1e3).toFixed(2))+" km",1)]),h.remainingDistance===0?(a(),l("div",Jt,v(h.quote),1)):p("",!0)])],2)):p("",!0)],64))),256))])]),_:1})])):(a(),l("div",Ot,[Et,V((a(),l("div",$t,[(a(!0),l(b,null,$(L(G),h=>(a(),l("div",{class:"journey",onClick:f=>L(P).startJourney(h.id)},[c("div",Pt,v(h.name),1),c("div",Rt,v(Math.ceil(o.miToKm(h.length_miles)))+" km",1)],8,xt))),256))])),[[d,,void 0,{y:!0}]])])),y(q,{name:"prompt"},{default:m(()=>[s.value?(a(),D(gt,{key:0,onClose:r[1]||(r[1]=h=>s.value=!1)})):p("",!0)]),_:1})])}}};export{Kt as default};
